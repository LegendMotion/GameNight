import{S as w}from"./assets/sweetalert2.esm.all-BQIkj5Wb.js";async function k(e="FEST123"){try{const t=await fetch(`/api/collection.php?gamecode=${e}`);if(!t.ok)throw new Error("Klarte ikke Ã¥ laste spillmodusen.");return await t.json()}catch(t){return console.error(t),null}}function v(e){let t=0;const o=r=>typeof r=="object"&&r.name?r.name:r,n=r=>typeof r=="object"&&typeof r.age=="number"?r.age:0,a={player:()=>{const r=Math.floor(Math.random()*e.length);return o(e[r])},next:()=>{const r=e[t%e.length];return t=(t+1)%e.length,o(r)},oldest:()=>{const r=e.reduce((i,c)=>n(c)>n(i)?c:i,e[0]);return o(r)}};return function(r){return e.length===0?r:r.replace(/{{(\w+)}}/gi,(i,c)=>{const s=a[c.toLowerCase()];return s?s():i})}}function b(e,t={}){const{containerId:o="app",nextBtnId:n="nextBtn",applyBackground:a=!0}=t,r=document.getElementById(o),i=new Set,c=JSON.parse(localStorage.getItem("players")||"[]"),s=v(c),u={challenge:{background:"/backgrounds/challenge.jpg",title:"/titles/challenge.png"},never:{background:"/backgrounds/jegharaldri.jpg",title:"/titles/jegharaldri.png"},spillthetea:{background:"/backgrounds/spillthetea.jpg",title:"/titles/spillthetea.png"},yayornay:{background:"/backgrounds/yayornay.jpg",title:"/titles/yayornay.png"}};function m(){const d=e.challenges.filter(y=>!i.has(y.id));if(d.length===0){r.innerHTML="<h2>Spillet er ferdig ðŸŽ‰</h2>";return}const g=d[Math.floor(Math.random()*d.length)];i.add(g.id);const p=r.querySelector(".challenge-card");p?(p.classList.add("fade-out"),p.addEventListener("transitionend",()=>h(g),{once:!0})):h(g)}function h(d){const g=u[d.type]||u.challenge;a&&(document.body.style.backgroundImage=`url('${g.background}')`),r.innerHTML=`
      <div class="challenge-card card-transition fade-in">
        <img src="${g.title}" alt="${d.type}" />
        <h3>${s(d.title)}</h3>
        <button id="${n}">Neste</button>
      </div>
    `;const p=r.querySelector(".challenge-card");requestAnimationFrame(()=>p.classList.remove("fade-in")),document.getElementById(n).addEventListener("click",m)}m()}function E(){const e=document.getElementById("app");e.innerHTML=`
    <div class="screen card-transition fade-in">
      <h2>Velg spillmodus</h2>
      <input id="gamecodeInput" placeholder="FEST123" />
      <button id="loadBtn">Start spill</button>
    </div>
  `;const t=e.querySelector(".screen");requestAnimationFrame(()=>t.classList.remove("fade-in")),document.getElementById("loadBtn").addEventListener("click",async()=>{const o=document.getElementById("gamecodeInput").value.trim(),n=await k(o);n?(localStorage.setItem("activeCollection",JSON.stringify(n)),b(n)):w.fire({icon:"error",title:"Oops... ",text:"Fant ikke spillmodus med kode "+o})})}function L(){const e=document.getElementById("app");e.innerHTML=`
    <div class="screen card-transition fade-in">
      <h2>Legg til spillere</h2>
      <ul id="playerList"></ul>
      <input id="playerName" placeholder="Spillernavn" />
      <button id="addPlayer">Legg til</button>
      <p id="playerMessage" style="color: red;"></p>
      <button id="continue">Fortsett</button>
    </div>
  `;const t=e.querySelector(".screen");requestAnimationFrame(()=>t.classList.remove("fade-in"));const o=document.getElementById("playerList"),n=[],a=document.getElementById("playerMessage");document.getElementById("addPlayer").addEventListener("click",()=>{const i=document.getElementById("playerName"),c=i.value.trim();if(!c){a.textContent="Skriv inn et navn.";return}if(n.includes(c)){a.textContent="Navnet er allerede lagt til.";return}n.push(c),r(),i.value="",a.textContent=""}),document.getElementById("continue").addEventListener("click",()=>{if(n.length<2){a.textContent="Legg til minst to spillere!";return}localStorage.setItem("players",JSON.stringify(n)),E()});function r(){o.innerHTML="",n.forEach((i,c)=>{const s=document.createElement("li");s.textContent=i;const u=document.createElement("button");u.textContent="Slett",u.addEventListener("click",()=>{n.splice(c,1),r(),n.length>=2&&(a.textContent="")}),s.appendChild(u),o.appendChild(s)})}}function I(){if("serviceWorker"in navigator)return navigator.serviceWorker.register("/service-worker.js").then(e=>{console.log("Service worker registered:",e)}).catch(e=>{console.error("Service worker registration failed:",e)})}function S({title:e,description:t,url:o,image:n,type:a="website"}={}){e&&(document.title=e),t&&l("name","description",t),o&&C(o),e&&l("property","og:title",e),t&&l("property","og:description",t),o&&l("property","og:url",o),l("property","og:type",a),n&&l("property","og:image",n),l("name","twitter:card",n?"summary_large_image":"summary"),e&&l("name","twitter:title",e),t&&l("name","twitter:description",t),n&&l("name","twitter:image",n)}function l(e,t,o){if(!o)return;let n=document.querySelector(`meta[${e}="${t}"]`);n||(n=document.createElement("meta"),n.setAttribute(e,t),document.head.appendChild(n)),n.setAttribute("content",o)}function C(e){let t=document.querySelector('link[rel="canonical"]');t||(t=document.createElement("link"),t.setAttribute("rel","canonical"),document.head.appendChild(t)),t.setAttribute("href",e)}async function j(){try{let r=function(){dataLayer.push(arguments)};const e=await fetch("/api/analytics.php");if(!e.ok)return;const{measurementId:t,anonymizeIp:o,respectDNT:n}=await e.json();if(!t||n&&(navigator.doNotTrack==="1"||window.doNotTrack==="1"||navigator.msDoNotTrack==="1"))return;const a=document.createElement("script");a.async=!0,a.src=`https://www.googletagmanager.com/gtag/js?id=${t}`,document.head.appendChild(a),window.dataLayer=window.dataLayer||[],window.gtag=r,r("js",new Date);const i={};o&&(i.anonymize_ip=!0),r("config",t,i)}catch(e){console.error("Analytics init failed",e)}}let f="";async function B(){if(!window.location.pathname.startsWith("/admin"))try{const e=await fetch("/api/ads.php");if(!e.ok)return;const{publisherId:t}=await e.json();if(!t)return;f=t;const o=document.createElement("script");o.async=!0,o.src=`https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=${encodeURIComponent(f)}`,o.crossOrigin="anonymous",document.head.appendChild(o)}catch(e){console.error("Ads init failed",e)}}document.addEventListener("DOMContentLoaded",()=>{L(),I(),S({title:"GameNight",url:window.location.href}),j(),B()});
