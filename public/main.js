import{S as f}from"./assets/sweetalert2.esm.all-BQIkj5Wb.js";async function k(e="FEST123"){try{const n=await fetch(`/api/collection.php?gamecode=${e}`);if(!n.ok)throw new Error("Klarte ikke Ã¥ laste spillmodusen.");return await n.json()}catch(n){return console.error(n),null}}function v(e){let n=0;const r=t=>typeof t=="object"&&t.name?t.name:t,a=t=>typeof t=="object"&&typeof t.age=="number"?t.age:0,i={player:()=>{const t=Math.floor(Math.random()*e.length);return r(e[t])},next:()=>{const t=e[n%e.length];return n=(n+1)%e.length,r(t)},oldest:()=>{const t=e.reduce((o,c)=>a(c)>a(o)?c:o,e[0]);return r(t)}};return function(t){return e.length===0?t:t.replace(/{{(\w+)}}/gi,(o,c)=>{const s=i[c.toLowerCase()];return s?s():o})}}function w(e,n={}){const{containerId:r="app",nextBtnId:a="nextBtn",applyBackground:i=!0}=n,t=document.getElementById(r),o=new Set,c=JSON.parse(localStorage.getItem("players")||"[]"),s=v(c),d={challenge:{background:"/backgrounds/challenge.jpg",title:"/titles/challenge.png"},never:{background:"/backgrounds/jegharaldri.jpg",title:"/titles/jegharaldri.png"},spillthetea:{background:"/backgrounds/spillthetea.jpg",title:"/titles/spillthetea.png"},yayornay:{background:"/backgrounds/yayornay.jpg",title:"/titles/yayornay.png"}};function p(){const l=e.challenges.filter(y=>!o.has(y.id));if(l.length===0){t.innerHTML="<h2>Spillet er ferdig ðŸŽ‰</h2>";return}const u=l[Math.floor(Math.random()*l.length)];o.add(u.id);const g=t.querySelector(".challenge-card");g?(g.classList.add("fade-out"),g.addEventListener("transitionend",()=>m(u),{once:!0})):m(u)}function m(l){const u=d[l.type]||d.challenge;i&&(document.body.style.backgroundImage=`url('${u.background}')`),t.innerHTML=`
      <div class="challenge-card card-transition fade-in">
        <img src="${u.title}" alt="${l.type}" />
        <h3>${s(l.title)}</h3>
        <button id="${a}">Neste</button>
      </div>
    `;const g=t.querySelector(".challenge-card");requestAnimationFrame(()=>g.classList.remove("fade-in")),document.getElementById(a).addEventListener("click",p)}p()}function L(){const e=document.getElementById("app");e.innerHTML=`
    <div class="screen card-transition fade-in">
      <h2>Velg spillmodus</h2>
      <input id="gamecodeInput" placeholder="FEST123" />
      <button id="loadBtn">Start spill</button>
    </div>
  `;const n=e.querySelector(".screen");requestAnimationFrame(()=>n.classList.remove("fade-in")),document.getElementById("loadBtn").addEventListener("click",async()=>{const r=document.getElementById("gamecodeInput").value.trim(),a=await k(r);a?(localStorage.setItem("activeCollection",JSON.stringify(a)),w(a)):f.fire({icon:"error",title:"Oops... ",text:"Fant ikke spillmodus med kode "+r})})}function I(){const e=document.getElementById("app");e.innerHTML=`
    <div class="screen card-transition fade-in">
      <h2>Legg til spillere</h2>
      <ul id="playerList"></ul>
      <input id="playerName" placeholder="Spillernavn" />
      <button id="addPlayer">Legg til</button>
      <p id="playerMessage" style="color: red;"></p>
      <button id="continue">Fortsett</button>
    </div>
  `;const n=e.querySelector(".screen");requestAnimationFrame(()=>n.classList.remove("fade-in"));const r=document.getElementById("playerList"),a=[],i=document.getElementById("playerMessage");document.getElementById("addPlayer").addEventListener("click",()=>{const o=document.getElementById("playerName"),c=o.value.trim();if(!c){i.textContent="Skriv inn et navn.";return}if(a.includes(c)){i.textContent="Navnet er allerede lagt til.";return}a.push(c),t(),o.value="",i.textContent=""}),document.getElementById("continue").addEventListener("click",()=>{if(a.length<2){i.textContent="Legg til minst to spillere!";return}localStorage.setItem("players",JSON.stringify(a)),L()});function t(){r.innerHTML="",a.forEach((o,c)=>{const s=document.createElement("li");s.textContent=o;const d=document.createElement("button");d.textContent="Slett",d.addEventListener("click",()=>{a.splice(c,1),t(),a.length>=2&&(i.textContent="")}),s.appendChild(d),r.appendChild(s)})}}function b(){if("serviceWorker"in navigator)return navigator.serviceWorker.register("/service-worker.js").then(e=>{console.log("Service worker registered:",e)}).catch(e=>{console.error("Service worker registration failed:",e)})}async function E(){try{let t=function(){dataLayer.push(arguments)};const e=await fetch("/api/analytics.php");if(!e.ok)return;const{measurementId:n,anonymizeIp:r,respectDNT:a}=await e.json();if(!n||a&&(navigator.doNotTrack==="1"||window.doNotTrack==="1"||navigator.msDoNotTrack==="1"))return;const i=document.createElement("script");i.async=!0,i.src=`https://www.googletagmanager.com/gtag/js?id=${n}`,document.head.appendChild(i),window.dataLayer=window.dataLayer||[],window.gtag=t,t("js",new Date);const o={};r&&(o.anonymize_ip=!0),t("config",n,o)}catch(e){console.error("Analytics init failed",e)}}let h="";async function S(){if(!window.location.pathname.startsWith("/admin"))try{const e=await fetch("/api/ads.php");if(!e.ok)return;const{publisherId:n}=await e.json();if(!n)return;h=n;const r=document.createElement("script");r.async=!0,r.src=`https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=${encodeURIComponent(h)}`,r.crossOrigin="anonymous",document.head.appendChild(r)}catch(e){console.error("Ads init failed",e)}}document.addEventListener("DOMContentLoaded",()=>{I(),b(),E(),S()});
